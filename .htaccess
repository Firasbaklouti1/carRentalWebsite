# --- start .htaccess ---
RewriteEngine On
RewriteBase /carrentalphp-main/
DirectoryIndex index.php index.html

# 1) Redirect /index or /index.php to site root for safe methods only (no POST redirect)
RewriteCond %{THE_REQUEST} \s/+(?:carrentalphp-main/)?index(?:\.php)?[?\s] [NC]
RewriteCond %{REQUEST_METHOD} !POST
RewriteRule ^(?:index(?:\.php)?)$ /carrentalphp-main/ [R=302,L]

# 2) Redirect direct browser requests for *.php -> extensionless (appearance only)
#    - Uses THE_REQUEST so internal rewrites won't trigger it
#    - Skips POST (so form submissions to .php are not turned into GET)
RewriteCond %{THE_REQUEST} \s/+(?:carrentalphp-main/)?([^\s]+?)\.php[?\s] [NC]
RewriteCond %{REQUEST_METHOD} !POST
RewriteRule ^ /carrentalphp-main/%1 [R=302,L,QSA]

# 3) If request maps to a real file/dir (images, css, existing files) skip further rules
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# 4) Internally rewrite extensionless URLs to the .php file (works for ALL methods)
#    Only when extensionless path doesn't exist and the corresponding .php exists.
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^([^.]+)$ $1.php [L,QSA]
# --- end .htaccess ---
